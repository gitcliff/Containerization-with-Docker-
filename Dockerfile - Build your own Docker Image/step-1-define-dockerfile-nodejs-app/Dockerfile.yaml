# ðŸ“¦ SUMMARY  
# This Dockerfile creates a lightweight Node.js containerized app that connects to MongoDB using environment variables.  
# Language/Platform: Dockerfile (Node.js on Alpine Linux)  
# What you'll learn: Setting environment variables, copying app code, installing dependencies, and starting the app inside a container  
# Outcome: A Docker image ready to run your Node.js app connecting to MongoDB with specified credentials  
# Why this matters: Simplifies app deployment and environment consistency in containers  

# ------------------------------  
# ðŸ§© SECTION TITLE: Base Image and Environment Setup  
# ------------------------------  
FROM node:20-alpine  
# âœ… What it does: Uses official Node.js 20 image based on Alpine Linux (small size) as the base environment  
# ðŸ§  Why it matters: Alpine keeps the image small and efficient for quick deployments  

ENV MONGO_DB_USERNAME=admin \
    MONGO_DB_PWD=pass  
# âœ… What it does: Sets two environment variables for MongoDB credentials inside the container  
# ðŸ§  Why it matters: Allows your app to read DB username and password from the environment, making config flexible and secure  

# ------------------------------  
# ðŸ§© SECTION TITLE: App Directory and Code Copy  
# ------------------------------  
RUN mkdir -p /home/app  
# âœ… What it does: Creates a directory `/home/app` inside the container for the app code  
# ðŸ§  Why it matters: Organizes files and ensures the working directory exists  

COPY ./app /home/app  
# âœ… What it does: Copies all files from local `./app` folder into `/home/app` in the container  
# ðŸ§  Why it matters: Moves your app source code into the image so it can be run inside the container  

WORKDIR /home/app  
# âœ… What it does: Sets `/home/app` as the current working directory for following commands  
# ðŸ§  Why it matters: Ensures subsequent commands run in the app directory  

# ------------------------------  
# ðŸ§© SECTION TITLE: Install Dependencies and Start App  
# ------------------------------  
RUN npm install  
# âœ… What it does: Runs npm to install all dependencies defined in your appâ€™s package.json  
# ðŸ§  Why it matters: Ensures the container has all required Node.js modules to run the app  

CMD ["node", "server.js"]  
# âœ… What it does: Defines the default command to start the Node.js server when the container runs  
# ðŸ§  Why it matters: Automatically launches your app without needing manual intervention  

# ------------------------------  
# âœ… NOTES / GOTCHAS / TIPS  
# ------------------------------  
# - Make sure your app reads Mongo credentials from environment variables (process.env.MONGO_DB_USERNAME etc.)  
# - Alpine images are minimal, so if you use native Node modules, you may need to install build tools (e.g., `apk add --no-cache make gcc g++ python3`)  
# - To build the image:  
#   docker build -t my-node-app .  
# - To run the container:  
#   docker run -e MONGO_DB_USERNAME=admin -e MONGO_DB_PWD=password -p 3000:3000 my-node-app  
