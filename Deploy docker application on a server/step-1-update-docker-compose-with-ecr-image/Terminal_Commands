# üì¶ SUMMARY  
# This code builds a Docker image, tags it for AWS Elastic Container Registry (ECR),  
# and pushes it to your private ECR repository. It demonstrates the full workflow  
# from local Docker development to preparing a container image for deployment in AWS.  
# Language/Platform: Bash (Linux/macOS) and PowerShell (Windows) with Docker & AWS CLI  
# What you'll learn: Docker image creation, tagging, listing images, authenticating with AWS ECR  
# Outcome: A Docker image is built locally and pushed to an AWS ECR repository  
# Why this matters: This is a key step for deploying containerized apps to AWS ECS, EKS, or Fargate  

# ------------------------------  
# üß© SECTION TITLE: Build Docker Image Locally  
# ------------------------------  
docker build -t my-app:1.0 .  
# ‚úÖ What it does: Builds a Docker image from the Dockerfile in the current directory (.) and tags it as "my-app:1.0"  
# üß† Why it matters: This creates a local container image that can be run or uploaded to a container registry  

# ------------------------------  
# üß© SECTION TITLE: View Local Docker Images  
# ------------------------------  
docker images  
# ‚úÖ What it does: Lists all Docker images stored locally on your machine  
# üß† Why it matters: Useful for verifying that "my-app:1.0" was built successfully and exists locally  

# ------------------------------  
# ‚öôÔ∏è SECTION TITLE: Tag Docker Image for AWS ECR  
# ------------------------------  
docker tag my-app:1.0 <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com/my-app:1.0  
# ‚úÖ What it does: Assigns a new tag to the image to match the AWS ECR repository format  
# üß† Why it matters: AWS ECR requires images to be tagged with your account's registry URL before pushing  

# üîÑ Example with your account redacted:  
# docker tag my-app:1.0 .dkr.ecr.us-east-1.amazonaws.com/my-app:1.0  
# ‚úÖ Here "" = AWS Account ID (keep it private), "us-east-1" = AWS region  

# ------------------------------  
# üß© SECTION TITLE: Verify Tagged Image Exists  
# ------------------------------  
docker images  
# ‚úÖ What it does: Again lists all Docker images to confirm the new tag was applied successfully  
# üß† Why it matters: Ensures you're pushing the correct image to ECR in the next step  

# ------------------------------  
# ‚öôÔ∏è SECTION TITLE: Authenticate Docker with AWS ECR  
# ------------------------------  
aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com  
# ‚úÖ What it does:  
# - Uses AWS CLI to fetch a login password for ECR (via `get-login-password`)  
# - Pipes it (`|`) to `docker login` to authenticate Docker with your AWS ECR registry  
# üß† Why it matters: Required before pushing images to AWS ECR so Docker knows where to send them  

# üîÑ Equivalent PowerShell command (Windows):  
# aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com  

# üîÑ Equivalent Bash command (Linux/macOS):  
# Same as above ‚Äî works identically  

# ------------------------------  
# üß™ SECTION TITLE: Output / Result / Log  
# ------------------------------  
# ‚úÖ What it does: Outputs "Login Succeeded" if authentication works  
# üß† Why it matters: Confirms Docker is now authenticated and ready to push images to AWS ECR  

# ------------------------------  
# ‚ñ∂Ô∏è HOW TO RUN / EXECUTE THIS CODE  
# ------------------------------  
# Step 1: Build image  
# docker build -t my-app:1.0 .  
# ‚úÖ Builds Docker image from current directory  

# Step 2: Tag image for ECR  
# docker tag my-app:1.0 <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com/my-app:1.0  
# ‚úÖ Prepares image for push to AWS  

# Step 3: Authenticate Docker with AWS  
# aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com  
# ‚úÖ Logs in to AWS ECR  

# Step 4: Push image to AWS ECR  
# docker push <AWS_ACCOUNT_ID>.dkr.ecr.us-east-1.amazonaws.com/my-app:1.0  
# ‚úÖ Uploads your Docker image to the AWS ECR repository  

# ------------------------------  
# ‚úÖ NOTES / GOTCHAS / TIPS  
# ------------------------------  
# - Replace <AWS_ACCOUNT_ID> with your 12-digit AWS account ID.  
# - Ensure your AWS CLI is configured (`aws configure`) with correct credentials and region.  
# - Your ECR repository must exist already. To create one:  
#   aws ecr create-repository --repository-name my-app --region us-east-1  
# - If login fails, check your IAM permissions for ECR actions.  
# - Common mistake: Forgetting to tag image with full ECR URL before pushing.  
